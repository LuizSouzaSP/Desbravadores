<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dashGeral | Aventura</title>

    <link rel="stylesheet" href="styles/dashgeral.css">
    <script src="../js/sessao.js"></script>
    <script src="./../js/alerta.js"></script>
    <script src="js/dadosQuiz.js"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <!-- <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script> -->
</head>

<!-- <body onload=" atualizarFeed()"> -->

<body>
    <div class="header">
        <div class="conteiner">
            <ul class="nav-bar">
                <li>
                    <div class="box">
                        <a href="dashboard.html">inicio</a>
                    </div>
                </li>
                <li>
                    <div class="box1">
                        <a href="quiz.html">Quiz</a>
                    </div>
                </li>
                <li>
                    <div class="box2">
                        <a href="conta.html">Conta</a>
                    </div>
                </li>
                <li>
                    <div class="box4">
                        <a href="#">Estatísticas Gerais</a>
                    </div>
                </li>
                <li>
                    <div class="box3">
                        <a href="index.html">Sair</a>
                    </div>
                </li>
            </ul>
            <div class="conteiner-graph">
                <div class="dash">
                    <div class="btns-dash" id="btnAquario">
                        <canvas id="myChart"></canvas>
                    </div>
                    <div class="dado-graph">
                        <span id="porcentGraph1"></span>
                    </div>
                </div>
                <div class="dash2">
                    <div class="btns-dash" id="btnAquario2">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
                <div class="dado-graph2">
                    <span id="porcentGraph2"></span>
                </div>
            </div>
    </div>
    </div>
</body>

</html>
<script>
    Questionario;

    let proximaAtualizacao;

    obterDadosGrafico();
    // obterDadosMaior();
function obterDadosGrafico() {

// alterarTitulo(idQuestionario)

if (proximaAtualizacao != undefined) {
    clearTimeout(proximaAtualizacao);
}
fetch(`/dash/buscar`, {
    method: 'GET',
    headers: {
        "Content-Type": "application/json"
    },   
}).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            console.log(resposta.clube)
            console.log(resposta.qtd)
            

            plotarGrafico(resposta);
            
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}
function plotarGrafico(resposta) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
const clube = resposta.map(item => item.clube)
const qtd = resposta.map(item => item.qtd)




// Criando estrutura para plotar gráfico - dados
const ctx = document.getElementById('myChart');

  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: clube,
      datasets: [{
        label: 'clubes',
        data: qtd,
        borderWidth: 1,
        backgroundColor: ['red', 'green', 'orange', 'blue', 'purple', 'gray', 'yellow', 'white', 'black', 'pink', 'violet', 'cyan', 'burlywood', 'brown', 'chartreuse', 'darkgray', 'darksalmon', 'olive', 'maroon']
      }
    ]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta[0])

// Inserindo valores recebidos em estrutura para plotar o gráfico

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log('Dados:')
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config


// Adicionando gráfico criado em div na tela
}
function obterDadosMaior() {

let maior = ''

if (proximaAtualizacao != undefined) {
    clearTimeout(proximaAtualizacao);
}
fetch(`/dash/maior`, {
    method: 'GET',
    headers: {
        "Content-Type": "application/json"
    },   
}).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            console.log(resposta.clube)
            let maior = resposta.clube
            
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
    porcentGraph1.innerHTML = (maior)
}
</script>